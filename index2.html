<!DOCTYPE html>
<html>
	<head>
		<title>AIno bot</title>
		<link rel="stylesheet" type="text/css" href="ainobot.css">
		<link rel="stylesheet" href="main.min.css">
		<script type="text/javascript" src="https://static.sketchfab.com/api/sketchfab-viewer-1.0.1.js"></script>
		<script type="text/javascript" src="character-1.0.0.js"></script>
		<script src="annyang.min.js"></script>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script src='https://code.responsivevoice.org/responsivevoice.js'></script>
	</head>
	<body>
		
	<!-- DRAW 3D CHARACTERS -->
		<!-- Hidden buttons used to control playing/pausing the 3D animation -->
		<p align="right" class="hidden">
			<button id="_play" type="button" title="play">play</button>
			<button id="_stop" type="button" title="stop">stop</button>
		</p>

		<!-- Insert an empty iframe for AIno 3D animation -->
		<iframe src="" id="aino-dancing" style="height: auto; border: none;" allowfullscreen mozallowfullscreen="true" webkitallowfullscreen="true" class="hidden"></iframe>
		<iframe src="" id="aino-idle" style="height: auto; border: none;" allowfullscreen mozallowfullscreen="true" webkitallowfullscreen="true" class="hidden"></iframe>
		<iframe src="" id="aino-talking" style="height: auto; border: none;" allowfullscreen mozallowfullscreen="true" webkitallowfullscreen="true" class="hidden"></iframe>
		 <!-- Insert an empty iframe, hidden by default using a class-->
		<!-- Initialize the viewer -->
    <script type="text/javascript">
			
		ainoIdle();
	    	ainoDancing();
		ainoTalking();


    </script>
		
	<!-- START SPEACH -->	
	
		<section id="section_header" class="sec">
			<h1>AIno bot</h1>
		</section>
    <section id="section_hei" class="sec">
      <p id="intro" class="hidden voice_instructions aino-speech">Tervehdys! Olen Ainobot, avustajasi digitalisaatiossa. Voit puhua minulle. Aloita sanomalla "Hei"!"</p>
      <p id="hei" class="hidden aino-speech">Heipä hei! Hauska tutustua. Sanotko ensiksi yrityksesi tai organisaatiosi nimen mahdollisimman selkeästi? Aloita sanomalla "<b>Nimi on</b>..."</p>
			<p id="p_org" class="hidden aino-speech">
				Kuulinko oikein: <input id="aino_org" type="text" size="20" class="aino-speech" />? Jos nimi ei ollut ihan oikein, kokeile sanoa oy tai oyj sanan perään tai ääntää englanninkielinen nimi suomalaisittain.
				</br>
				</br>
				Ole hyvä ja vahvista nimi oikeaksi sanomalla "<b>Nimi oikein</b>".
			</p>
			<div id="p_question1" class="hidden aino-speech">
				Valitse paras vaihtoehto sanomalla "Vastaus" ja vatauksen kirjain.
				Kysymys 1: Tärkein syy digitalisaatioon organisaatiossamme on:
				<ul>
					<li>
						<input type="radio" name="question1" id="vastausA1">
						<label for="f-option">A) Organisaationi saa digitaalisuudesta suhteellista etua muihin nähden, olemme jo diginatiiveja</label>
						<div class="check"></div>
					</li>
					<li>
						<input type="radio" name="question1" id="vastausB1">
						<label for="f-option">B) Digitaalisuuden saavuttamiseksi nykyisiä toimintamalleja tai tietojärjestelmiä ei tarvitse muuttaa kovin paljon</label>
						<div class="check"></div>
					</li>
					
					<li>
						<input type="radio" name="question1" id="vastausC1">
						<label for="f-option">C) Kilpailutilanne pakottaa meidät digitalisaatioon</label>
						<div class="check"></div>
					</li>
					<li>
						<input type="radio" name="question1" id="vastausD1">
						<label for="f-option">D) Digitalisaatio ei kosketa meitä</label>
						<div class="check"></div>
					</li>
				</ul>
			</div>

			<div id="p_question2" class="hidden aino-speech">
				Kysymys 2. Yhteiskehittely asiakkaiden kanssa ja valmius kumppanuuksiin:
	
				<ul>
					<li>
						<input type="radio" name="question2" id="vastausA2">
						<label for="f-option">A) Organisaationi saa digitaalisuudesta suhteellista etua muihin nähden, olemme jo diginatiiveja</label>
						<div class="check"></div>
					</li>
					<li>
						<input type="radio" name="question2" id="vastausB2">
						<label for="f-option">B) Digitaalisuuden saavuttamiseksi nykyisiä toimintamalleja tai tietojärjestelmiä ei tarvitse muuttaa kovin paljon</label>
						<div class="check"></div>
					</li>
					
					<li>
						<input type="radio" name="question2" id="vastausC2">
						<label for="f-option">C) Kilpailutilanne pakottaa meidät digitalisaatioon</label>
						<div class="check"></div>
					</li>
					<li>
						<input type="radio" name="question2" id="vastausD2">
						<label for="f-option">D) Digitalisaatio ei kosketa meitä</label>
						<div class="check"></div>
					</li>
				</ul>
			</div>

			<div id="p_question3" class="hidden aino-speech">
				Kysymys 3. Digitalisaation esteet:
	
				<ul>
					<li>
						<input type="radio" name="question3" id="vastausA3">
						<label for="f-option">A) Emme näe mitään isoja esteitä</label>
						<div class="check"></div>
					</li>
					<li>
						<input type="radio" name="question3" id="vastausB3">
						<label for="f-option">B) Organisaation on iso ja muutos on suuri ja tulee viemään pitkään</label>
						<div class="check"></div>
					</li>
					
					<li>
						<input type="radio" name="question3" id="vastausC3">
						<label for="f-option">C) Digitalisaatioon liittyy turvallisuusuhkia ja muita suuria kustannuksia aiheuttavia muutoksia</label>
						<div class="check"></div>
					</li>
					<li>
						<input type="radio" name="question3" id="vastausD3">
						<label for="f-option">D) Emme tunne vielä tarpeeksi digitalisaation tarvittavia teknologioita ja niiden mahdollisuuksia</label>
						<div class="check"></div>
					</li>
				</ul>
			</div>
			<div id="section_email" class="hidden aino-speech">
				<p>Tuloksesi on <input id="aino_tulos" type="text" size="20" class="aino-speech" /></p>
				<form name="contact" action="thank-you" netlify="">
					<p>
						<label>Your Name: <input type="text" name="name" id="recipient_name"></label>
					</p>
					<p>
						<label>Your Email: <input type="email" name="email" id="recipient_email"></label>
					</p>
					<p>
					    <label>Message: <textarea name="message" id="recipient_message"></textarea></label>
					  </p>
					<p>
						<button type="submit" id="result_form">Send</button>
					</p>
				</form>
			</div>
		</section>
    <div id="unsupported" class="hidden">
      <h4>It looks like your browser doesn't support speech recognition.</h4>
      <p>annyang plays nicely with all browsers, progressively enhancing modern browsers that support the SpeechRecognition standard, while leaving users with older browsers unaffected.</p>
      <p>Please visit <a href="http://www.annyangjs.com/">http://www.annyangjs.com/</a> in a desktop browser like Chrome.</p>
    </div>
		<script>
    "use strict";
		var digipoints_raw = 0; //these points are added everytime user answers question or analysis is ready
		var digipoints_percentile = 0; // categorized digipoints with scale of 1-5
		
		var answers = []; //array of all answers as they are. First answer is the company name
		var answers_score = []; //array of each answer's score. First answer is company name which has score 0.
		var lastanswered = 0; //sequence number of the last already answered question to follow where user is
		
		var companyname = "";
		
		function speak_aino(speechtext) {
			// meSpeak.speak calls the pause3D as callback when finished
			hideIdle();
			responsiveVoice.speak(speechtext, "Finnish Female", {rate: 1.5});
			setTimeout(enterIdle, 6500);
		}
		
		function enterIdle() {
			$("#aino-talking").addClass("hidden");
			$("#aino-idle").removeClass("hidden");
			$("#aino-idle").animate({zIndex: 100, opacity: 1}, "slow");			
		}
			
		function hideIdle() {
			$("#aino-talking").removeClass("hidden");
			$("#aino-idle").animate({zIndex: -100, opacity: 0}, "slow");
			$("#aino-idle").addClass("hidden");
		}

		function play3D() {
			//$( '#_play' ).prop('checked', true);
			$( '#_play' ).trigger('click');
			//$( '#_play' ).click(function() {console.log("play.click")});
		}

		function pause3D() {
			//$( '#_play' ).prop('checked', fal<se);
			$( '#_stop' ).trigger('click');
			//$( '#_stop' ).click(function() {console.log("stop.click")});
		}

		var f_AIno_initialize = function () {
			$("#intro").slideDown("slow");
			speak_aino('Tervehdys! Olen Ainobot, avustajasi digitalisaatiossa. Voit puhua minulle. Aloita sanomalla hei!');
			
		};

		// This function is called when the AIno 3D-model iframe is loaded
		function AIno_intro() {
			// JS way to have pause before calling f_AIno_initialize
			$('#aino-idle').ready(function () {
				enterIdle();
				hideIdle();
				setTimeout(f_AIno_initialize, 2000);
			});
			play3D();			
		}

			
    if (annyang) {

      // define the functions our commands will run.
     			 var hello = function() {
				$("#intro").slideUp("slow");
				$("#hei").slideDown("slow");
				scrollTo("#section_hei");
				speak_aino('Heipä hei! Hauska tutustua! Sanotko ensiksi yrityksesi tai organisaatiosi nimen mahdollisimman selkeästi? Aloita sanomalla "Nimi on"');
    			  };

			var get_org = function(heard_org) {
				$("#hei").slideUp("slow");
        			$("#p_org").slideDown("slow");
				document.getElementById("aino_org").value = heard_org.toString();
				speak_aino('Kuulinko oikein, sanoitko '+heard_org.toString());
				companyname = heard_org.toString();
				answers[lastanswered] = companyname;
				answers_score[lastanswered] = 0;
      			 };

			var got_name_right = function() {
				$("#p_org").slideUp("slow");
				$("#p_question1").slideDown("slow");
				speak_aino('Valitse paras vaihtoehto sanomalla vaihtoehdon teksti');
			}
			
			var next_question = function() {
				// calculate score
				// if lastanswered == 3 then present total and show form
				lastanswered++;
				console.log(lastanswered);
				let next = lastanswered+1;
				let qname = '#p_question'+next;
				$("#p_question"+lastanswered).slideUp("slow");
				$(qname).slideDown("slow");
				speak_aino('Kysymys numero'+next);
			}

			var choose_vastausA = function() {
				let answeredelement = lastanswered+1
				document.getElementById("vastausA"+answeredelement).checked = true;
				// push answer to array
				answers[lastanswered+1] = "A";
				answers_score[lastanswered+1] = 1;
			}
			var choose_vastausB = function() {
				let answeredelement = lastanswered+1
				document.getElementById("vastausB"+answeredelement).checked = true;
				answers[lastanswered+1] = "B";
				answers_score[lastanswered+1] = 0.75;
			}
			var choose_vastausC = function() {
				let answeredelement = lastanswered+1
				document.getElementById("vastausC"+answeredelement).checked = true;
				answers[lastanswered+1] = "C";
				answers_score[lastanswered+1] = 0.50;				
			}
			var choose_vastausD = function() {
				let answeredelement = lastanswered+1
				document.getElementById("vastausD"+answeredelement).checked = true;
				answers[lastanswered+1] = "D";
				answers_score[lastanswered+1] = 0;
			}
			
			var results = function() {
				lastanswered++;
				digipoints_raw = answers_score[1]+answers_score[2]+answers_score[3]; //täydennä loput
				//laske percentile
				//näytä kuva
				document.getElementById("aino_tulos").value = digipoints_raw.toString();
				$("#recipient_message").val(digipoints_raw.toString());
				$("#p_question"+lastanswered).slideUp("slow");
				$(section_email).slideDown("slow");
				console.log(answers[0]);
				console.log(answers[1]);
				console.log(answers[2]);
				console.log(answers[3]);
				//console.log(answers[4]);
				//console.log(answers[5]);
				console.log(answers_score[0]);
				console.log(answers_score[1]);
				console.log(answers_score[2]);
				console.log(answers_score[3]);
				//console.log(answers_score[4]);
				//console.log(answers_score[5]);
				console.log(answers_score[1]+answers_score[2]+answers_score[3]);
			}

			var get_name = function(heard_name) {
				document.getElementById("recipient_name").value = heard_name.toString();
				speak_aino('Kuulinko oikein, sanoitko '+heard_name.toString());
      			 };
	    
	    		var get_email = function(heard_email1,heard_email2,heard_domain) {
				document.getElementById("recipient_email").value = heard_email1.toString()+'.'heard_email2.toString()+'@'+heard_domain().toString;
				speak_aino('Kuulinko oikein, sanoitko '+heard_email1.toString()+'.'heard_email2.toString()+'@'+heard_domain().toString);
      			 };

	    	    	var send_form = function() {
				$( '#result_form' ).trigger('click');
				speak_aino('Lomake lähetetty');
      			 };



      // Let's define our first command. First the text we expect, and then the function it should call
      var commands = {
        			'hei': hello,
				'nimi on *hear_org':  get_org,
				'nimi oikein': got_name_right,
				'vastaus A': choose_vastausA,
	      			'vastaus B': choose_vastausB,
				'vastaus C': choose_vastausC,
				'vastaus D': choose_vastausD,
	      			'seuraava kysymys': next_question,
	      			'tulos': results,
	      			'nimeni on *hear_name': get_name,
	      			'sähköpostiosoitteeni on *hear_email1 piste *hear_email2 at *hear_domain': get_email,
	      			'lähetä lomake': send_form

      };

      // OPTIONAL: activate debug mode for detailed logging in the console
      annyang.debug();

      // Add our commands to annyang
      annyang.addCommands(commands);

      // OPTIONAL: Set a language for speech recognition (defaults to English)
      // For a full list of language codes, see the documentation:
      // https://github.com/TalAter/annyang/blob/master/docs/FAQ.md#what-languages-are-supported
      annyang.setLanguage('fi');

      // Start listening. You can call this here, or attach this call to an event, button, etc.
      annyang.start();

			var scrollTo = function(identifier, speed) {
		    $('html, body').animate({
		        scrollTop: $(identifier).offset().top
		    }, speed || 1000);
		  }
    } else {
      $(document).ready(function() {
        $('#unsupported').fadeIn('fast');
      });
    }
			

    </script>

	</body>
</html>
